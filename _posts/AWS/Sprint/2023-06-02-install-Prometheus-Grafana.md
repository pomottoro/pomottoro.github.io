---
title: "Prometheus, Grafana ì„¤ì¹˜"
excerpt: "Prometheus, Grafana"

categories: ["Sprint"]
tags: ["ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë§", "Prometheus", "Grafana"]

date: 2023-06-02
last_modified_at: 2023-06-02
<<<<<<< HEAD

header:
  overlay_image: assets/images/Thumbnail/infinite.jpg
  overlay_filter: 0.5 
  teaser: assets/images/Thumbnail/Sprint-thumbnail.png
published: true
=======
>>>>>>> parent of df92387f (ëŒ€ê·œëª¨ ì—…ë°ì´íŠ¸)
---

# ğŸ’¡ Prometheus, Grafana ì„¤ì¹˜

---

## Prometheus Operatorë¥¼ ì´ìš©í•˜ì—¬ ì„¤ì¹˜í•˜ê¸°

minikubeë¥¼ ì´ìš©í•´ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. `--nodes` ì˜µì…˜ì„ ì´ìš©í•˜ì—¬ ì—¬ëŸ¬ ê°œì˜ ë…¸ë“œë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
minikube start --nodes=3
```

![image](https://github.com/pomottoro/comments/assets/58872932/8eb7783c-a7e5-404d-b3f5-b0acb0546ec9)

- í„°ë¯¸ë„ì—ì„œ ë¯¸ë‹ˆíë¸Œë¡œ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„± í•˜ëŠ” ëª¨ìŠµ.

 ì—¬ëŸ¬ ê°œì˜ ë…¸ë“œë¥¼ ë§Œë“¤ë©´, ì²« ë²ˆì§¸ëŠ” master, ë‚˜ë¨¸ì§€ ë‘ ê°œì˜ ë…¸ë“œëŠ” worker ë…¸ë“œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. ì—¬ëŸ¬ ê°œì˜ ë…¸ë“œë¥¼ êµ¬ì„±í•  ê²½ìš°, ì›Œì»¤ ë…¸ë“œì—ëŠ” ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°ì¹˜í•˜ë©°, ë§ˆìŠ¤í„° ë…¸ë“œëŠ” í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ ê·¸ ìì²´ì— ì§‘ì¤‘í•˜ê²Œ í•©ë‹ˆë‹¤.

> Q. ëª¨ë‹ˆí„°ë§ì˜ ê´€ì ì—ì„œ ì›Œì»¤ ë…¸ë“œì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³„ë„ë¡œ ë°°ì¹˜í•˜ëŠ” ê²ƒì´ ì™œ ìœ ë¦¬í• ê¹Œìš”?
>
> - A. ì›Œì»¤ ë…¸ë“œì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³„ë„ë¡œ ë°°ì¹˜í•˜ëŠ” ê²ƒì´ ëª¨ë‹ˆí„°ë§ ê´€ì ì—ì„œ ìœ ë¦¬í•œ ì´ìœ 
>
>   1. **ë¶„ë¦¬ëœ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬:** ê° ì›Œì»¤ ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í•´ë‹¹ ë…¸ë“œì˜ ë¦¬ì†ŒìŠ¤(CPU, ë©”ëª¨ë¦¬, ìŠ¤í† ë¦¬ì§€ ë“±)ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. ì´ë¡œ ì¸í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°„ì˜ ë¦¬ì†ŒìŠ¤ ê²½í•©ì„ ë°©ì§€í•˜ê³ , ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ ë…ë¦½ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê³  ìµœì í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
>   2. **ì¥ì•  ê²©ë¦¬:** ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³„ë„ì˜ ì›Œì»¤ ë…¸ë“œì— ë°°ì¹˜í•˜ë©´, í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œê°€ ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê²ƒì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë°œìƒí•œ ë²„ê·¸ë‚˜ ê³¼ë„í•œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ë“±ì´ í•´ë‹¹ ë…¸ë“œ ë‚´ì—ì„œ ê²©ë¦¬ë˜ì–´, ì „ì²´ ì‹œìŠ¤í…œì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ê²ƒì„ ìµœì†Œí™”í•©ë‹ˆë‹¤.
>
>   3. **ì„¸ë¶€ ëª¨ë‹ˆí„°ë§:** ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³„ë„ì˜ ì›Œì»¤ ë…¸ë“œì— ë°°ì¹˜í•˜ë©´, ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„¸ë¶€ì ì¸ ë™ì‘ ìƒí™©ì„ ë”ìš± ì •í™•í•˜ê²Œ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, ì• í”Œë¦¬ì¼€ì´ì…˜ ë³„ë¡œ íŠ¸ë˜í”½, CPU ì‚¬ìš©ëŸ‰, ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë“±ì˜ ë©”íŠ¸ë¦­ì„ ë”°ë¡œ ëª¨ë‹ˆí„°ë§í•˜ê³  ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
>   4. **ìœ ì—°í•œ ìŠ¤ì¼€ì¼ë§:** ê° ì›Œì»¤ ë…¸ë“œì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³„ë„ë¡œ ë°°ì¹˜í•˜ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ê°ê°ì˜ ì›Œì»¤ ë…¸ë“œë¥¼ ë…ë¦½ì ìœ¼ë¡œ í™•ì¥í•˜ê±°ë‚˜ ì¶•ì†Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´ë‹¤ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
>
>   ì´ëŸ¬í•œ ì´ìœ ë“¤ë¡œ ì¸í•´, í° ê·œëª¨ì˜ ì‹œìŠ¤í…œì—ì„œëŠ” ì›Œì»¤ ë…¸ë“œì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë³„ë„ë¡œ ë°°ì¹˜í•˜ëŠ” ê²ƒì´ ìœ ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì´ ë°©ì‹ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì¶”ê°€ë¡œ ì‚¬ìš©í•˜ë¯€ë¡œ, ì‘ì€ ê·œëª¨ì˜ ì‹œìŠ¤í…œì—ì„œëŠ” ë¹„íš¨ìœ¨ì ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê·œëª¨ì™€ ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì ì ˆí•œ ë°°ì¹˜ ì „ëµì„ ì„ íƒí•´ì•¼ í•©ë‹ˆë‹¤.
>

```bash
$ minikube status
minikube
type: Control Plane
host: Running
kubelet: Running
apiserver: Running
kubeconfig: Configured

minikube-m02
type: Worker
host: Running
kubelet: Running

minikube-m03
type: Worker
host: Running
kubelet: Running
```

![image](https://github.com/pomottoro/comments/assets/58872932/3e6d1607-66d4-42ea-b294-ebd58cc727f2)

- ë¯¸ë‹ˆíë¸Œ ìƒíƒœ

---

## ğŸ· Prometheus Operator Quick Start

[Prometheus ê³µì‹ ë¬¸ì„œ](https://prometheus-operator.dev/docs/prologue/quick-start/)

1. kube-prometheusë¥¼ í´ë¡ í•˜ì„¸ìš”.

   ```bash
   git clone https://github.com/prometheus-operator/kube-prometheus.git
   ```

   ![image](https://github.com/pomottoro/comments/assets/58872932/4895e6da-e3e7-4cfd-93d6-99b166471a17)

2. í•´ë‹¹ ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ì—¬ kube-prometheusë¥¼ ë°°í¬í•˜ì„¸ìš”.

   ```bash
   # STEP 1
   kubectl create -f manifests/setup
   # STEP 2
   until kubectl get servicemonitors --all-namespaces ; do date; sleep 1; echo ""; done
   # STEP 3
   kubectl create -f manifests/
   ```

   1. `manifests/setup` ì•ˆì˜ ì›Œí¬ë¡œë“œë¥¼ ì „ë¶€ ì‹¤í–‰í•©ë‹ˆë‹¤.
   2. ì¼ë‹¨ ëª¨ë“  ëª¨ë“  ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°(servicemonitor)ê°€ êµ¬ë™ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
   3. `manifest/` ì•ˆì˜ ì›Œí¬ë¡œë“œë¥¼ ì „ë¶€ ì‹¤í–‰í•©ë‹ˆë‹¤.

3. Prometheus Operator ê´€ë ¨ ì„œë¹„ìŠ¤ ë° ì›Œí¬ë¡œë“œê°€ ì‹¤í–‰ë˜ê¸° ì „ê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.

4. ê´€ë ¨ ì„œë¹„ìŠ¤ë¥¼ ë¡œì»¬í˜¸ìŠ¤íŠ¸ì— í¬íŠ¸ í¬ì›Œë”©ìœ¼ë¡œ ë…¸ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

   1. í”„ë¡œë©”í…Œìš°ìŠ¤ ë…¸ì¶œ

      ```bash
      kubectl --namespace monitoring port-forward svc/prometheus-k8s 9090
      ```

      [http://localhost:9090](http://localhost:9090/)ë¡œ ì ‘ì†í•´ì„œ í”„ë¡œë©”í…Œìš°ìŠ¤ì— ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

      ![image](https://github.com/pomottoro/comments/assets/58872932/e9f1651a-ca23-45f0-ab02-363dfb5a8f2e)

      ![image](https://github.com/pomottoro/comments/assets/58872932/99d83194-146e-4835-ae2f-2a9d2f2d0a0e)
   
      

   2. ê·¸ë¼íŒŒë‚˜ ë…¸ì¶œ
   
      ```bash
      kubectl --namespace monitoring port-forward svc/grafana 3000
      ```
   
      [http://localhost:3000](http://localhost:3000/)ìœ¼ë¡œ ì ‘ì†í•´ì„œ ê·¸ë¼íŒŒë‚˜ì— ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì´ˆê¸° ì‚¬ìš©ì ì´ë¦„ê³¼ ë¹„ë°€ë²ˆí˜¸ëŠ” `admin`/`admin`ì…ë‹ˆë‹¤)
      
      ![image](https://github.com/pomottoro/comments/assets/58872932/1c61838b-abdf-413b-8e67-179789b34919)
      
      ![image](https://github.com/pomottoro/comments/assets/58872932/bcc6935a-b87a-417e-8c8e-3fbd42316263)
      
      - localhost:3000 ìœ¼ë¡œ ì ‘ì†ì‹œ ë‚˜ì˜¤ëŠ” í™”ë©´
      
      ![image](https://github.com/pomottoro/comments/assets/58872932/6d9f38eb-f9ec-4db2-9382-1f10cd46faca)
      
      - admin/admin ìœ¼ë¡œ ë¡œê·¸ì¸ í›„ í™”ë©´

<br>

---

<br>